\section{Windfarm problem implementation}
    \subsection{Summary}
    This implementation of the windfarm maintenance problem is done using GLPK/GMPL
    (GNU Linear Programming Kit and Modelling language GNU MathProg). The program is broken down to
    3 input and 2 output files:
    \begin{itemize}
        \item Input files
            \begin{itemize}
                \item \textit{windfarm.mod}: model file containing the core of the modelling problem.
                Declares sets, parameters, conditions and the objective of the modelling exercise.
                Also, the file includes \textit{printf} statements that generates more readable output
                than the standard built-in one in \textit{GLPK}. This customized output is available in 
                the \textit{report.txt} file.
                \item \textit{wfmaintenance.dat}: data file with initialization of sets and parameters 
                related to maintenance jobs. Additionally, the parameter matrix \textit{main\_req\_st} 
                that links maintenance tasks and staff related parameters is also initialized here.
                Following parameters are initialized here:
                \begin{itemize}
                    \item set MaintenanceTypes
                    \item set MaintenanceSeverity
                    \item param main\_req
                    \item param main\_req\_xp
                    \item param main\_req\_st
                    \item param main\_burnout
                    \item param burnout\_coef
                    \item param main\_material\_cost
                \end{itemize}
                \item \textit{wfstaff.dat}: data file initializing staff related sets and parameters.
                \begin{itemize}
                    \item set StaffTypes
                    \item set StaffLevels
                    \item param staff\_level\_xp
                    \item param staff\_cost
                \end{itemize}
            \end{itemize}
        \item Output files
            \begin{itemize}
                \item \textit{output.txt}: standard output file generated by the \textit{glpsol} 
                command with the \textit{-o} parameter. The file shows the values of all variables 
                and the values used for resolving the conditions specified in the .mod file.
                \item \textit{report.txt}: customized output generated by the \textit{printf} 
                statements at the end of the \textit{windfarm.mod} file. Contentwise same as 
                \textit{output.txt}.
            \end{itemize}
    \end{itemize}

    \subsection{Model setup}

        \subsubsection{Conditions and variables}
        The condition section of the modelling file is broken down to 4 main sections, XP conditions,
        Staff conditions, Minimum maintenance and Burnout indicators respectively. The XP condition 
        takes care of that the hired staff have at least as much XP points that is necessary to be able
        to carry out the required maintenance tasks. The following variables are calculated within this
        section: 
        \newpage
        
        \subparagraph{XP conditions} \label{xp condition} \text{} \newline
        \hspace*{.5cm}Firstly, redundant variables:
        %total_main_req_xp[mt] = (if main_req[mt,"severe"] <> 0 then main_req_xp[mt,"severe"] else main_req_xp[mt,"normal"]);
        \begin{equation}
            %\hfilneg 
            \underset{mt\times 1}{\mathrm{\text{total\_main\_req\_xp}}} = 
            \begin{cases}
                \underset{mt\times ms}{\text{main\_req\_xp[mt,"severe"]}}, \underset{mt\times ms}{\text{ if } \text{main\_req\_xp[mt,"severe"]}} > 0\\[3ex]
                \underset{mt\times ms}{\text{main\_req\_xp[mt,"normal"]}}, \text{ otherwise}\\
            \end{cases}
            %\hspace{10000pt minus 1fil}
        \end{equation}

        %total_staff_xp[st] = sum{sl in StaffLevels} staff_to_hire[st,sl] * staff_level_xp[sl];
        \begin{equation}
            %\hfilneg
            \underset{st\times 1}{\text{total\_staff\_xp}} =  
                \underset{st\times sl}{\text{staff\_to\_hire}}\times \underset{sl\times 1}{\text{staff\_level\_xp}}
            %\hspace{10000pt minus 1fil}
        \end{equation}

        %total_staff_xp_task[mt] = sum{st in StaffTypes} if main_req_st[mt,st] <> 0 then total_staff_xp[st] else 0 ;
        \begin{equation}
            %\hfill
            \underset{mt\times 1}{\text{total\_staff\_xp\_task}} =
            \begin{cases}
                \underset{st\times 1}{\text{total\_staff\_xp[st]}}, \underset{mt\times st}{\text{ if } \text{main\_req\_st[mt,st]}} > 0\\[3ex]
                0, \text{ otherwise}
            \end{cases}
            %\hspace{10000pt minus 1fil}
        \end{equation} \newline

        \text{Finally, the required condition is}
        %total_staff_xp_task[mt] >= total_main_req_xp[mt];
        \begin{equation}
            \underset{mt\times 1}{\text{total\_staff\_xp\_task}} >=  
                \underset{mt\times 1}{\text{total\_main\_req\_xp}}
        \end{equation}

        \subparagraph{Staff conditions} \label{staff condition} \text{} \newline
        \hspace*{.5cm}Again, introduce (this time only one) redundant variable:
        %total_staff[st] = sum{sl in StaffLevels} staff_to_hire[st,sl];
        \begin{equation}
            \underset{st\times 1}{\text{total\_staff}} = 
                \sum_{sl}\underset{st\times sl}{\text{staff\_to\_hire[st,sl]}}
        \end{equation}

        \text{The staff condition is}
        %total_staff[st] >= main_req_st[mt, st];
        \begin{equation}
            \underset{st\times 1}{\text{total\_staff}} >= 
                \sum_{mt}\underset{mt\times st}{\text{main\_req\_st}^T\text{[mt,st]}}
        \end{equation}

        \subparagraph{Minimum maintenance} \label{minimum maintenance} \text{} \newline
        \hspace*{.5cm}No redundant variables this time:
        %quantity[mt] >= sum{ms in MaintenanceSeverity} main_req[mt,ms];
        \begin{equation}
            \underset{mt\times 1}{\text{quantity}} >= 
                \sum_{ms}\underset{mt\times ms}{\text{main\_req[mt,ms]}}
        \end{equation}

        \subparagraph{Burnout condition} \label{burnout condition} \text{} \newline
        \hspace*{.5cm}Redundant variables:
        %weighted_maintenance_tasks[mt] = sum{ms in MaintenanceSeverity} main_req[mt,ms] * main_burnout[ms];
        \begin{equation}
            %\hfilneg
            \underset{mt\times 1}{\text{weighted\_maintenance\_tasks}} =  
                \underset{mt\times ms}{\text{main\_req[mt,ms]}}\times \underset{ms\times 1}{\text{main\_burnout[ms]}}
            %\hspace{10000pt minus 1fil}
        \end{equation}

        %total_req_wgt_staff[st] = sum{mt in MaintenanceTypes} weighted_maintenance_tasks[mt] * main_req_st[mt,st];
        \begin{equation}
            %\hfilneg
            \underset{1\times st}{\text{total\_req\_wgt\_staff}} =  
                \underset{mt\times 1}{{\text{weighted\_maintenance\_tasks}^T\text{[mt]}}}\times \underset{mt\times st}{\text{main\_req\_st[mt,st]}}
            %\hspace{10000pt minus 1fil}
        \end{equation}

        The required burnout condition is:
        %total_req_wgt_staff[st] <= total_staff[st] * burnout_coef;
        \begin{equation}
            \underset{st\times 1}{\text{total\_req\_wgt\_staff[st]}} <= 
                \underset{st\times 1}{\text{total\_staff[st]}} * \text{burnout\_coef}
        \end{equation}

        where \newline
            \hspace*{.75cm} \textit{mt} is in MaintenanceTypes \newline
            \hspace*{.75cm} \textit{ms} is in MaintenanceSeverity \newline
            \hspace*{.75cm} \textit{st} is in StaffTypes \newline
            \hspace*{.75cm} \textit{st} is in StaffLevels \newline
        \hspace*{.55cm}sets.

        \subsubsection{Objective}
        The objective function of the modelling exercise is minimizing total costs obtained as the 
        sum of material and staff related costs while fulfilling required maintenance tasks given 
        the conditions. Total staff cost is obtained by multiplying matrices 
        \textit{staff\_to\_hire} and \textit{staff\_cost} and then taking the trace of the resulting
        matrix:
        \[
            \text{TotalStaffCost} = 
            \text{tr}\left( \underset{(st \times sl)}{\text{staff\_to\_hire}} \times
            \underset{(st \times sl)}{\text{staff\_cost}^T}\right)
        \]

        Total material cost can be obtained by simply taking the sumproduct of vectors
        \textit{main\_material\_cost} and \textit{quantity}:
        \[
            \text{TotalMaterialCost} = 
            \sum_{mt}\text{main\_maintenance\_cost[mt]} * \text{quantity[mt]}
        \]

        Objective to be minimized:
        \begin{equation}
            \text{minimize TotalCosts} = 
                \text{TotalStaffCost} + \text{TotalMaterialCost}
        \end{equation}

    \subsection{Sample input/output}
        \subsubsection{Parameter main\_req}
        The parameter contains the required number of maintenance jobs (rows) based on severity 
        (columns). The required number of maintenance jobs per types is given by the row sums 
        (summed over severity level). The row sums are used in the condition \nameref{minimum maintenance}.
        \begin{table}[H]
            \begin{center}
                %\begin{tabular}{ | p{10em} | p{1.5cm} | p{1.5cm} | }
                \begin{tabular}{ |c|c|c| } 
                \hline
                \multirow{2}{*}{Maintenance Type} &
                \multicolumn{2}{|c|}{Maintenance Severity}\\
                \cline{2-2}\cline{3-3}
                & normal & severe \\ 
                \hline
                blades    & 12 & 5  \\ 
                gearbox   & 13 & 3  \\ 
                generator & 6  & 10 \\ 
                sensors   & 8  & 1  \\ 
                wiring    & 9  & 0  \\ 
                \hline
                \end{tabular}
            \end{center}
        \caption{main\_req} % displayed in doc
        \label{param_main_req} % for reference
        \end{table}

        \subsubsection{Parameter main\_req\_xp}
        The parameter contains the required experience points for the maintenance jobs (rows) 
        based on severity (columns). In case the value for the "severe" task in \textit{main\_req} 
        is greater than zero, the experience points defined in this parameter matrix is taken from
        the "severe" column and from the "normal" otherwise (see \nameref{xp condition}). 
        \begin{table}[H]
            \begin{center}
                %\begin{tabular}{ | p{10em} | p{1.5cm} | p{1.5cm} | }
                \begin{tabular}{ |c|c|c| } 
                \hline
                \multirow{2}{*}{Maintenance Type} &
                \multicolumn{2}{|c|}{Maintenance Severity}\\
                \cline{2-2}\cline{3-3}
                & normal & severe \\ 
                \hline
                blades    & 50  & 125  \\ 
                gearbox   & 125 & 150  \\ 
                generator & 113 & 230 \\ 
                sensors   & 110 & 150  \\ 
                wiring    & 30  & 50  \\ 
                \hline
                \end{tabular}
            \end{center}
        \caption{main\_req\_xp} % displayed in doc
        \label{param_main_req} % for reference
        \end{table}

        \subsubsection{Parameter main\_req\_st}
        The parameter holds the number of personnel required to do the specific maintenance job. E.g.
        the "blades" task requires 3 mechanics and 4 storage personnel to move the blades from the
        storage to the windfarm site and fix them. 
        \begin{table}[H]
            \begin{center}
                %\begin{tabular}{ | p{10em} | p{1.5cm} | p{1.5cm} | }
                \begin{tabular}{ |c|c|c|c|c| } 
                \hline
                \multirow{2}{*}{Maintenance Type} &
                \multicolumn{4}{|c|}{Staff Type}\\
                \cline{2-5}
                & electric & mechanic & storage & software \\ 
                \hline
                blades    & 0 & 3 & 4 & 0 \\ 
                gearbox   & 3 & 4 & 0 & 1 \\ 
                generator & 4 & 3 & 0 & 1 \\ 
                sensors   & 5 & 3 & 1 & 3 \\ 
                wiring    & 3 & 0 & 3 & 2 \\ 
                \hline
                \end{tabular}
            \end{center}
        \caption{main\_req\_st} % displayed in doc
        \label{param_main_req_st} % for reference
        \end{table}

        \subsubsection{Parameter main\_burnout and burnout\_coef}
        The parameter tells how exhausting the task is for the staff based on severity. The higher 
        the value, the more the task weighs when calculating the number of tasks per staff member.
        The latter is represented by the parameter \textit{burnout\_coef} and is set to \textbf{15} 
        meaning that no more than 15 tasks can be assigned to 1 staff member.
        \begin{table}[H]
            \begin{center}
                %\begin{tabular}{ | p{10em} | p{1.5cm} | p{1.5cm} | }
                \begin{tabular}{ |c|c| } 
                \hline
                Maintenance Severity & Value \\
                \hline
                normal   & .75 \\ 
                severe   & 1.3 \\ 
                \hline
                \end{tabular}
            \end{center}
        \caption{main\_burnout} % displayed in doc
        \label{param_main_burnout} % for reference
        \end{table}

        \subsubsection{Parameter main\_material\_cost}
        The parameter contains the cost of material associated with the maintenance tasks.
        \begin{table}[H]
            \begin{center}
                %\begin{tabular}{ | p{10em} | p{1.5cm} | p{1.5cm} | }
                \begin{tabular}{ |c|c| } 
                \hline
                Maintenance Type & Material Cost \\ 
                \hline
                blades    & 100 \\ 
                gearbox   & 150 \\ 
                generator & 120 \\ 
                sensors   & 50  \\ 
                wiring    & 70  \\ 
                \hline
                \end{tabular}
            \end{center}
        \caption{main\_material\_cost} % displayed in doc
        \label{param_main_material_cost} % for reference
        \end{table}

        \subsubsection{Parameter staff\_level\_xp}
        The parameter contains the experience points associated to level of the staff. The higher the 
        level, the more experience point the person has (and also more expensive).
        \begin{table}[H]
            \begin{center}
                %\begin{tabular}{ | p{10em} | p{1.5cm} | p{1.5cm} | }
                \begin{tabular}{ |c|c| } 
                \hline
                Staff Level & XP \\
                \hline
                junior   & 2  \\ 
                middle   & 15 \\ 
                senior   & 40 \\
                \hline
                \end{tabular}
            \end{center}
        \caption{staff\_level\_xp} % displayed in doc
        \label{param_staff_level_xp} % for reference
        \end{table}

        \subsubsection{Parameter staff\_cost}
        The parameter holds the cost of hiring staff of given type and experience level.
        \begin{table}[H]
            \begin{center}
                %\begin{tabular}{ | p{10em} | p{1.5cm} | p{1.5cm} | }
                \begin{tabular}{ |c|c|c|c| } 
                \hline
                \multirow{2}{*}{Staff Type} &
                \multicolumn{3}{|c|}{Staff Level}\\
                \cline{2-4}
                & junior & middle & senior \\ 
                \hline
                electric   & 10 & 15 & 40 \\ 
                mechanic   & 8  & 18 & 30 \\ 
                storage    & 12 & 15 & 20 \\ 
                software   & 10 & 40 & 50 \\
                \hline
                \end{tabular}
            \end{center}
        \caption{staff\_cost} % displayed in doc
        \label{param_staff_cost} % for reference
        \end{table}

        \subsubsection{Generated output}
        The section shows the generated output based on the above input and model setup. The output 
        can be found in the \textbf{output.txt} and also in the \textbf{report.txt} files. The latter
        is scripted in the \textit{windfarm.mod} and provides a more readable format of the output.

    \subsection{Effect of parameters}